(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{280:function(e,r,t){},281:function(e,r,t){"use strict";t.r(r);var n=t(0),c=t.n(n),a=t(50),i=t(29),o=t(14),s=t(16),l=t(17),j=t(24),d=t(25),u=t(1),h=function(e){Object(j.a)(t,e);var r=Object(d.a)(t);function t(e){var n;return Object(s.a)(this,t),(n=r.call(this,e)).state={hasError:!1},n}return Object(l.a)(t,[{key:"componentDidCatch",value:function(e,r){console.error(e,r)}},{key:"render",value:function(){return this.state.hasError?Object(u.jsx)("h1",{children:"Something went wrong."}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(c.a.Component),b=t(340),O=t(336),x=t(334),f=t(335),g=t(337),p=t(338),v=t(339),m=t(332),y=t(318);function w(){return Object(u.jsx)(x.a,{sx:{flexGrow:1},children:Object(u.jsx)(f.a,{position:"static",children:Object(u.jsxs)(g.a,{children:[Object(u.jsx)(p.a,{disabled:!0,size:"large",edge:"start",color:"inherit",sx:{mr:2},children:Object(u.jsx)(y.a,{})}),Object(u.jsx)(v.a,{component:i.b,to:"/",sx:{flexGrow:1,textAlign:"center",typography:"h6",color:"inherit",textDecoration:"none"},children:"ISSA Races"}),Object(u.jsx)(m.a,{color:"inherit",disabled:!0,children:"Login"})]})})})}function C(){return Object(u.jsx)(b.a,{children:Object(u.jsxs)(O.a,{elevation:12,children:[Object(u.jsx)(w,{}),Object(u.jsx)(o.a,{})]})})}var S=t(40),I=t(12);var k=t(341);function E(){return Object(u.jsx)(O.a,{sx:{m:"auto",py:4},children:Object(u.jsx)(x.a,{sx:{textAlign:"center"},children:Object(u.jsx)(k.a,{})})})}var B=t(287);function D(e){var r=e.message;return Object(u.jsxs)(O.a,{sx:{m:"auto",p:4},children:[Object(u.jsx)(B.a,{variant:"h6",align:"center",color:"error",gutterBottom:!0,children:"Application Error"}),Object(u.jsx)(B.a,{variant:"body1",align:"center",color:"error",children:r})]})}function R(e){var r=e.uri,t=e.stateVersion,c=e.renderSuccess,a=e.loadingFallback,i=void 0===a?Object(u.jsx)(E,{}):a,o=e.renderError,s=void 0===o?function(e){var r=e.message;return r=r||"Fetch error",Object(u.jsx)(D,{message:r})}:o,l=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=Object(n.useState)(),i=Object(I.a)(a,2),o=i[0],s=i[1],l=Object(n.useState)(),j=Object(I.a)(l,2),d=j[0],u=j[1],h=Object(n.useState)(!0),b=Object(I.a)(h,2),O=b[0],x=b[1];return Object(n.useEffect)((function(){var r=!1;if(!e)return u(new Error("Empty URI")),s(void 0),void x(!1);x(!0);var n={method:t};return c&&(n.headers={"Content-Type":"application/json; charset=utf-8"},n.body=JSON.stringify(c)),fetch(e,n).then((function(e){var r=e.headers.get("Content-Type");if(e.ok&&"application/json; charset=utf-8"===r)return e.json();throw console.error("Unexpected response status '".concat(e.status,"' or content type '").concat(r,"'")),new Error("".concat(e.status," Fetch failed"))})).then((function(e){r||(s(e),u(void 0))})).catch((function(e){r||(u(e),s(void 0))})).finally((function(){r||x(!1)})),function(){r=!0}}),[e,r,t,c]),{loading:O,data:o,error:d}}(r,t),j=l.loading,d=l.data,h=l.error;return j?i:h?s(h):d?c({data:d}):void 0}var T=t(342),q=t(343),F=t(344),W=t(345),_=t(346),z=t(347),A=["title","spot","date","type","location"];function N(e){var r=e.data,t=Object(o.g)();if(null===r||void 0===r||!r.races)return Object(u.jsx)(O.a,{children:"No data"});var n=r.races;return Object(u.jsx)(O.a,{children:Object(u.jsx)(T.a,{children:Object(u.jsxs)(q.a,{size:"small",children:[Object(u.jsx)(F.a,{children:Object(u.jsx)(W.a,{sx:{bgcolor:"grey.300"},children:A.map((function(e){return Object(u.jsx)(_.a,{align:"right",children:e},e)}))})}),Object(u.jsx)(z.a,{children:n.map((function(e){var r;return Object(u.jsxs)(W.a,{sx:{"&:last-child td, &:last-child th":{border:0},"&:hover":{bgcolor:"grey.200"},cursor:"pointer"},onClick:function(){return t("/races/".concat(e._id))},children:[Object(u.jsx)(_.a,{align:"right",children:e.title}),Object(u.jsx)(_.a,{align:"right",children:e.spot}),Object(u.jsx)(_.a,{align:"right",children:new Date(e.date).toLocaleDateString()}),Object(u.jsx)(_.a,{align:"right",children:e.type}),Object(u.jsx)(_.a,{align:"right",children:null===(r=e.location)||void 0===r?void 0:r.name})]},e._id)}))})]})})})}function G(){var e="".concat("https://issaraces.herokuapp.com/api/v1/","races");return Object(u.jsx)(R,{uri:e,renderSuccess:function(e){return Object(u.jsx)(N,Object(S.a)({},e))}})}var J=t(27),L=function(e){return(e/1e3).toFixed(2)},U=function(e){return 100*e},M=function(e,r){return e+U(r)},V=function(e){var r,t=[],n=Object(J.a)(e);try{for(n.s();!(r=n.n()).done;){var c,a=r.value,i=[],o=Object(J.a)(a.runs);try{for(o.s();!(c=o.n()).done;){var s=c.value;i.push(M(s.raw,s.cones))}}catch(l){o.e(l)}finally{o.f()}t.push(Math.max.apply(Math,i))}}catch(l){n.e(l)}finally{n.f()}return t},P=function(e){return e.reduce((function(e,r){return e+r}))/e.length};function K(e){var r=e.data,t=Object(o.g)();if(null===r||void 0===r||!r.racers)return Object(u.jsx)(O.a,{children:"No data"});var n=function(){var e=[],t=[1];return function(n){if(0===e.length){var c,a=Object(J.a)(r.racers);try{for(a.s();!(c=a.n()).done;){var i=c.value,o=P(V(i.parts));e.push(o)}}catch(l){a.e(l)}finally{a.f()}e.sort((function(e,r){return e-r}));for(var s=1;s<e.length;s++)e[s]>e[s-1]?t[s]=s+1:t[s]=t[s-1]}return t[e.indexOf(n)]}}();return Object(u.jsx)(O.a,{children:Object(u.jsx)(T.a,{children:Object(u.jsxs)(q.a,{sx:{minWidth:480},size:"small",children:[Object(u.jsx)(F.a,{children:Object(u.jsx)(W.a,{sx:{bgcolor:"grey.300"},children:["start","name","result","place"].map((function(e){return Object(u.jsx)(_.a,{align:"right",children:e},e)}))})}),Object(u.jsx)(z.a,{children:r.racers.map((function(e){var r=P(V(e.parts)),c=n(r);return Object(u.jsxs)(W.a,{sx:{"&:last-child td, &:last-child th":{border:0},"&:hover":{bgcolor:"grey.200"},cursor:"pointer"},onClick:function(){return t("racers/".concat(e.issa_id))},children:[Object(u.jsx)(_.a,{align:"right",children:e.start}),Object(u.jsx)(_.a,{align:"right",children:e.name}),Object(u.jsx)(_.a,{align:"right",children:L(r)}),Object(u.jsx)(_.a,{align:"right",children:c})]},e.issa_id)}))})]})})})}var H=t(329),Q=t(348),X=t(321),Y=t(349),Z=t(90),$=t.n(Z);function ee(e){var r,t=e.data;return null!==t&&void 0!==t&&t.racers?Object(u.jsx)(O.a,{children:Object(u.jsxs)(H.a,{sx:{bgcolor:"lightyellow"},children:[Object(u.jsx)(Q.a,{expandIcon:Object(u.jsx)($.a,{}),children:Object(u.jsx)(B.a,{children:t.title+", "+t.spot+", "+(r=t.date,new Date(r).toLocaleDateString())})}),Object(u.jsx)(X.a,{}),Object(u.jsx)(Y.a,{children:Object(u.jsxs)(B.a,{children:["Type: ",t.type,Object(u.jsx)("br",{}),"Location: ",t.location.name,Object(u.jsx)("br",{}),"Geo: ",t.location.geo[0],", ",t.location.geo[1],Object(u.jsx)("br",{}),"Organizer: ",t.org.name,", ",t.org.email,Object(u.jsx)("br",{}),t.org.comment,Object(u.jsx)("br",{})]})})]})}):Object(u.jsx)(O.a,{children:"No data"})}var re=function(e){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(ee,Object(S.a)({},e)),Object(u.jsx)(K,Object(S.a)({},e))]})};function te(){var e=Object(o.h)(),r="".concat("https://issaraces.herokuapp.com/api/v1/","races/").concat(e.raceId);return Object(u.jsx)(R,{uri:r,renderSuccess:function(e){return Object(u.jsx)(re,Object(S.a)({},e))}})}function ne(e){var r=e.data,t=e.onEditRun,n=r.parts;return Object(u.jsx)(O.a,{children:Object(u.jsx)(T.a,{children:Object(u.jsxs)(q.a,{sx:{minWidth:480},size:"small",children:[Object(u.jsx)(F.a,{children:Object(u.jsx)(W.a,{sx:{bgcolor:"grey.300"},children:["course","direction","raw","cones","penalty","time"].map((function(e){return Object(u.jsx)(_.a,{align:"right",children:e},e)}))})}),Object(u.jsx)(z.a,{children:[].concat(n.map((function(e,n){return e.runs.map((function(n,c){return Object(u.jsxs)(W.a,{sx:{"&:last-child td, &:last-child th":{border:0},"&:hover":{bgcolor:"grey.200"},cursor:"pointer"},onClick:function(){var c={racer:r.name,racerId:r.issa_id,runId:n._id,direction:e.direction,course:e.course,raw:n.raw,cones:n.cones};t(c)},children:[Object(u.jsx)(_.a,{align:"right",children:e.course}),Object(u.jsx)(_.a,{align:"right",children:e.direction}),Object(u.jsx)(_.a,{align:"right",children:L(n.raw)}),Object(u.jsx)(_.a,{align:"right",children:n.cones}),Object(u.jsx)(_.a,{align:"right",children:L(U(n.cones))}),Object(u.jsx)(_.a,{align:"right",children:L(M(n.raw,n.cones))})]},n._id)}))})))})]})})})}function ce(e){var r=e.data,t=r.parts,n=V(t),c=P(n);return Object(u.jsx)(O.a,{children:Object(u.jsxs)(H.a,{sx:{bgcolor:"lightgreen"},children:[Object(u.jsx)(Q.a,{expandIcon:Object(u.jsx)($.a,{}),children:Object(u.jsx)(B.a,{children:r.name})}),Object(u.jsx)(X.a,{}),Object(u.jsx)(Y.a,{children:Object(u.jsxs)(B.a,{children:["ISSA ID: ",r.issa_id,Object(u.jsx)("br",{}),"Start: ",r.start,Object(u.jsx)("br",{}),"Result: ",L(c),Object(u.jsx)("br",{})]})})]})})}var ae=t(150),ie=t(117),oe=t.n(ie),se=t(156),le=t(62),je=t(350),de=t(324),ue=t(351),he=t(352),be=t(326),Oe=t(330),xe=t(353),fe=["straight","irregular"],ge=["in","out"],pe=le.b({course:le.c("Course type").oneOf(fe).required("Course type is required"),direction:le.c("Direction").oneOf(ge).required("Direction is required"),raw:le.a("Raw time").required("Raw time is required").positive(),cones:le.a("Cones displaced").required("Cones displaced is required").integer("Should be integer").min(0,"Cannot be be negative").max(5,"< 5")});function ve(e){var r=e.open,t=e.runDetails,c=e.onSubmit,a=e.onCancel,i=e.raceId,o=Object(n.useCallback)(function(){var e=Object(ae.a)(oe.a.mark((function e(r){var n,a;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat("https://issaraces.herokuapp.com/api/v1/","races/").concat(i,"/racers/").concat(t.racerId,"/runs/").concat(t.runId),a={method:"PUT",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({raw:(o=r.raw,1e3*o),cones:r.cones})},e.next=4,fetch(n,a).then((function(e){var r=e.headers.get("Content-Type");if(e.ok&&"application/json; charset=utf-8"===r)return e.json();throw new Error("Unexpected response status '".concat(e.status,"' or content type '").concat(r,"'"))})).then((function(e){console.log(e)})).catch((function(e){console.warn("error: ",e)})).finally((function(){c()}));case 4:case"end":return e.stop()}var o}),e)})));return function(r){return e.apply(this,arguments)}}(),[c,i,t.racerId,t.runId]),s=Object(se.a)({enableReinitialize:!0,initialValues:{course:t.course,direction:t.direction,raw:L(t.raw),cones:t.cones},validationSchema:pe,onSubmit:o});return Object(u.jsxs)(je.a,{open:r,onClose:a,children:[Object(u.jsxs)(de.a,{children:["Add run",Object(u.jsx)(B.a,{color:"warning.main",children:"(course/direction update tbd)"})]}),Object(u.jsxs)(ue.a,{children:[Object(u.jsx)(he.a,{children:t.racer||"Racer Name"}),Object(u.jsx)(be.a,{autoFocus:!0,fullWidth:!0,select:!0,id:"course",name:"course",label:"Course",margin:"dense",variant:"filled",value:s.values.course,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.course&&Boolean(s.errors.course),helperText:s.touched.course&&s.errors.course,children:fe.map((function(e){return Object(u.jsx)(Oe.a,{value:e,children:e},e)}))}),Object(u.jsx)(be.a,{fullWidth:!0,select:!0,id:"direction",name:"direction",label:"Direction",margin:"dense",variant:"filled",value:s.values.direction,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.direction&&Boolean(s.errors.direction),helperText:s.touched.direction&&s.errors.direction,children:ge.map((function(e){return Object(u.jsx)(Oe.a,{value:e,children:e},e)}))}),Object(u.jsx)(be.a,{fullWidth:!0,id:"raw",name:"raw",label:"Raw",margin:"dense",variant:"filled",type:"number",inputProps:{step:"0.01"},value:s.values.raw,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.raw&&Boolean(s.errors.raw),helperText:s.touched.raw&&s.errors.raw}),Object(u.jsx)(be.a,{fullWidth:!0,id:"cones",name:"cones",label:"Cones",margin:"dense",variant:"filled",type:"number",value:s.values.cones,onChange:s.handleChange,onBlur:s.handleBlur,error:s.touched.cones&&Boolean(s.errors.cones),helperText:s.touched.cones&&s.errors.cones})]}),Object(u.jsxs)(xe.a,{children:[Object(u.jsx)(m.a,{variant:"outlined",fullWidth:!0,disabled:s.isSubmitting,onClick:s.handleSubmit,children:s.isSubmitting?Object(u.jsx)(k.a,{size:30}):"OK"}),Object(u.jsx)(m.a,{variant:"outlined",fullWidth:!0,onClick:a,children:"Cancel"})]})]})}var me=function(e){var r=e.data,t=e.raceId,c=e.onRefresh,a=Object(n.useState)(!1),i=Object(I.a)(a,2),o=i[0],s=i[1],l=Object(n.useState)({}),j=Object(I.a)(l,2),d=j[0],h=j[1],b=Object(n.useCallback)((function(e){h(e),s(!0)}),[]),O=Object(n.useCallback)((function(){s(!1),c()}),[c]),x=Object(n.useCallback)((function(){s(!1)}),[]);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(ce,{data:r}),Object(u.jsx)(ne,{data:r,onEditRun:b}),Object(u.jsx)(ve,{open:o,runDetails:d,onSubmit:O,onCancel:x,raceId:t})]})};function ye(){var e=Object(o.h)(),r="".concat("https://issaraces.herokuapp.com/api/v1/","races/").concat(e.raceId,"/racers/").concat(e.racerId),t=Object(n.useState)(0),c=Object(I.a)(t,2),a=c[0],i=c[1],s=Object(n.useCallback)((function(){i((function(e){return e+1}))}),[]);return Object(u.jsx)(R,{uri:r,stateVersion:a,renderSuccess:function(r){return Object(u.jsx)(me,Object(S.a)(Object(S.a)({},r),{},{raceId:e.raceId,onRefresh:s}))}})}function we(){var e=Object(o.f)();return console.log(e),Object(u.jsx)(O.a,{sx:{m:"auto",p:4},children:Object(u.jsxs)(B.a,{align:"center",color:"error",children:["Resource not found at ",e.pathname]})})}t(280);Object(a.render)(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(h,{children:Object(u.jsx)(i.a,{children:Object(u.jsx)(o.d,{children:Object(u.jsxs)(o.b,{path:"/",element:Object(u.jsx)(C,{}),children:[Object(u.jsx)(o.b,{index:!0,element:Object(u.jsx)(G,{})}),Object(u.jsx)(o.b,{path:"races/:raceId",element:Object(u.jsx)(te,{})}),Object(u.jsx)(o.b,{path:"races/:raceId/racers/:racerId",element:Object(u.jsx)(ye,{})}),Object(u.jsx)(o.b,{path:"*",element:Object(u.jsx)(we,{})})]})})})})}),document.getElementById("root"))}},[[281,1,2]]]);
//# sourceMappingURL=main.dfd9186d.chunk.js.map